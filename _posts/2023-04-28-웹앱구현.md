---
layout: single
title:  "ë¨¸ì‹ ëŸ¬ë‹ ì›¹ ì•± êµ¬í˜„"
categories: coding
tag: [python, blog, ML]
toc: true
author_profile: false
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


# ë°ì´í„° ê°€ì ¸ì˜¤ê¸°



```python
import pandas as pd
import numpy as np

ufos = pd.read_csv('ufos.csv')
ufos.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>city</th>
      <th>state</th>
      <th>country</th>
      <th>shape</th>
      <th>duration (seconds)</th>
      <th>duration (hours/min)</th>
      <th>comments</th>
      <th>date posted</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10/10/1949 20:30</td>
      <td>san marcos</td>
      <td>tx</td>
      <td>us</td>
      <td>cylinder</td>
      <td>2700.0</td>
      <td>45 minutes</td>
      <td>This event took place in early fall around 194...</td>
      <td>4/27/2004</td>
      <td>29.883056</td>
      <td>-97.941111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10/10/1949 21:00</td>
      <td>lackland afb</td>
      <td>tx</td>
      <td>NaN</td>
      <td>light</td>
      <td>7200.0</td>
      <td>1-2 hrs</td>
      <td>1949 Lackland AFB&amp;#44 TX.  Lights racing acros...</td>
      <td>12/16/2005</td>
      <td>29.384210</td>
      <td>-98.581082</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10/10/1955 17:00</td>
      <td>chester (uk/england)</td>
      <td>NaN</td>
      <td>gb</td>
      <td>circle</td>
      <td>20.0</td>
      <td>20 seconds</td>
      <td>Green/Orange circular disc over Chester&amp;#44 En...</td>
      <td>1/21/2008</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10/10/1956 21:00</td>
      <td>edna</td>
      <td>tx</td>
      <td>us</td>
      <td>circle</td>
      <td>20.0</td>
      <td>1/2 hour</td>
      <td>My older brother and twin sister were leaving ...</td>
      <td>1/17/2004</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10/10/1960 20:00</td>
      <td>kaneohe</td>
      <td>hi</td>
      <td>us</td>
      <td>light</td>
      <td>900.0</td>
      <td>15 minutes</td>
      <td>AS a Marine 1st Lt. flying an FJ4B fighter/att...</td>
      <td>1/22/2004</td>
      <td>21.418056</td>
      <td>-157.803611</td>
    </tr>
  </tbody>
</table>
</div>


### ë¨¼ì € "ufos" ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì„ ê°€ì§„ ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•œ í›„, "Country" í•„ë“œì˜ ê³ ìœ í•œ ê°’ì„ í™•ì¸í•œë‹¤."



```python
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})

ufos.Country.unique()
```

<pre>
array(['us', nan, 'gb', 'ca', 'au', 'de'], dtype=object)
</pre>
### ê²°ì¸¡ì¹˜ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë„ê°’ì„ ì „ë¶€ ì œê±°í•œ í›„ 1~60ì´ˆ ì‚¬ì´ì˜ ê´€ì¸¡ê°’ë§Œì„ ê°€ì ¸ì˜¨ë‹¤.



```python
ufos.dropna(inplace=True)

ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
Int64Index: 25863 entries, 2 to 80330
Data columns (total 4 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Seconds    25863 non-null  float64
 1   Country    25863 non-null  object 
 2   Latitude   25863 non-null  float64
 3   Longitude  25863 non-null  float64
dtypes: float64(3), object(1)
memory usage: 1010.3+ KB
</pre>
### "Scikit-learnì˜ LabelEncoder ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ êµ­ê°€ë³„ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•œë‹¤.

### LabelEncoderëŠ” ë°ì´í„°ë¥¼ ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì¸ì½”ë”©í•œë‹¤.



```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])

ufos.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Seconds</th>
      <th>Country</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>20.0</td>
      <td>3</td>
      <td>53.200000</td>
      <td>-2.916667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20.0</td>
      <td>4</td>
      <td>28.978333</td>
      <td>-96.645833</td>
    </tr>
    <tr>
      <th>14</th>
      <td>30.0</td>
      <td>4</td>
      <td>35.823889</td>
      <td>-80.253611</td>
    </tr>
    <tr>
      <th>23</th>
      <td>60.0</td>
      <td>4</td>
      <td>45.582778</td>
      <td>-122.352222</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3.0</td>
      <td>3</td>
      <td>51.783333</td>
      <td>-0.783333</td>
    </tr>
  </tbody>
</table>
</div>


# ëª¨ë¸ êµ¬ì¶•


### X ë²¡í„°ë¡œ ì‚¬ìš©í•  ì„¸ ê°€ì§€ íŠ¹ì„±ì„ ì„ íƒí•˜ê³ , y ë²¡í„°ëŠ” êµ­ê°€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì…ë ¥ê°’ìœ¼ë¡œ 'ì´ˆ', 'ìœ„ë„', 'ê²½ë„'ë¥¼ ì…ë ¥í•˜ë©´ êµ­ê°€ IDê°€ ë°˜í™˜ë  ìˆ˜ ìˆë„ë¡ í•™ìŠµí•˜ë„ë¡ ë§Œë“ ë‹¤.



```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features]
y = ufos['Country']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```

### ëª¨ë¸ì„ ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ êµ¬í˜„í•œë‹¤.



```python
from sklearn.metrics import accuracy_score, classification_report
from sklearn.linear_model import LogisticRegression
model = LogisticRegression(max_iter=1000)
model.fit(X_train, y_train)
predictions = model.predict(X_test)
print(classification_report(y_test, predictions))
print('Predicted labels: ', predictions)
print('Accuracy: ', accuracy_score(y_test, predictions))
```

<pre>
              precision    recall  f1-score   support

           0       1.00      1.00      1.00        41
           1       0.85      0.46      0.60       250
           2       1.00      1.00      1.00         8
           3       1.00      1.00      1.00       131
           4       0.97      1.00      0.98      4743

    accuracy                           0.97      5173
   macro avg       0.96      0.89      0.92      5173
weighted avg       0.97      0.97      0.97      5173

Predicted labels:  [4 4 4 ... 3 4 4]
Accuracy:  0.970036729170694
</pre>
### ì´ ëª¨ë¸ì˜ ì •í™•ë„ëŠ” ì•½ 96í¼ì„¼íŠ¸ ì •ë„ë¡œ ê½¤ ë†’ë‹¤ êµ­ê°€ì™€ ìœ„ë„/ê²½ë„ê°€ ìƒê´€ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

### í•˜ì§€ë§Œ ì´ëª¨ë¸ì´ í˜ì‹ ì ì´ì§€ëŠ” ì•Šë‹¤. ìœ„ë„ì™€ ê²½ë„ ì •ë³´ë§Œìœ¼ë¡œ ì¼ë°˜ì ìœ¼ë¡œë„ ì‰½ê²Œ êµ­ê°€ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

### ê·¸ëŸ¼ì—ë„ ì´ ì˜ˆì œëŠ” ë°ì´í„°ë¥¼ ì •ì œí•˜ê³ , ë‚´ë³´ë‚´ê³ , ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•´ë³¼ ìˆ˜ ìˆëŠ” ì—°ìŠµìœ¼ë¡œì¨ ìœ ìš©í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•œë‹¤.


# ëª¨ë¸ì„ pickle í•˜ëŠ” ê³¼ì •


### ëª¨ë¸ì„ picklingí•œ í›„, pickleë¡œë¶€í„° ëª¨ë¸ì„ ë¡œë“œí•˜ê³ , ì´ˆ, ìœ„ë„, ê²½ë„ ê°’ì„ í¬í•¨í•˜ëŠ” ìƒ˜í”Œ ë°ì´í„° ë°°ì—´ì— ëŒ€í•´ í…ŒìŠ¤íŠ¸í•œë‹¤.



```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('ufo-model.pkl','rb'))
pred_x=pd.DataFrame(np.array([50,44,-12]).reshape(1,-1),
                   columns=['Seconds','Latitude','Longitude']) 
print(model.predict(pred_x))
```

<pre>
[3]
</pre>
### ëª¨ë¸ì€ 3ì„ ë°˜í™˜í•˜ë©° ì´ëŠ” UKì˜ êµ­ê°€ì½”ë“œì´ë‹¤.


# Flask ì•±ì„ ë§Œë“¤ì–´ì„œ ëª¨ë¸ í˜¸ì¶œ


### ì¼ë‹¨ ì•„ë˜ì˜ ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤.

## 1.í˜„ì¬ ì‘ì—…ì¤‘ì¸ ë…¸íŠ¸ë¶ íŒŒì¼ì´ ìˆëŠ” ìœ„ì¹˜ì—ì„œ web-appì´ë¼ëŠ” í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

## 2.web-app í´ë” ì•ˆì— staticì´ë¼ëŠ” í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

## 3.static í´ë” ì•ˆì— cssë¼ëŠ” í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

## 4.web-app í´ë” ì•ˆì— templatesë¼ëŠ” í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.


### web-app í´ë” ì•ˆì— requirements.txt íŒŒì¼ì„ ìƒì„±í•œë‹¤. ì´ íŒŒì¼ì€ JavaScript ì•±ì—ì„œì˜ package.json íŒŒì¼ê³¼ ê°™ì´, ì•±ì—ì„œ í•„ìš”ë¡œ í•˜ëŠ” ì˜ì¡´ì„±ì„ ë‚˜ì—´í•œë‹¤.



```python
cd web-app
```

<pre>
C:\Users\rvf67\My project\web-app
</pre>

```python
pip install -r requirements.txt
```

<pre>
Requirement already satisfied: scikit-learn in c:\users\rvf67\anaconda3\lib\site-packages (from -r requirements.txt (line 1)) (1.2.1)
Requirement already satisfied: pandas in c:\users\rvf67\anaconda3\lib\site-packages (from -r requirements.txt (line 2)) (1.5.3)
Requirement already satisfied: numpy in c:\users\rvf67\anaconda3\lib\site-packages (from -r requirements.txt (line 3)) (1.23.5)
Requirement already satisfied: flask in c:\users\rvf67\anaconda3\lib\site-packages (from -r requirements.txt (line 4)) (2.2.2)
Requirement already satisfied: scipy>=1.3.2 in c:\users\rvf67\anaconda3\lib\site-packages (from scikit-learn->-r requirements.txt (line 1)) (1.10.0)
Requirement already satisfied: threadpoolctl>=2.0.0 in c:\users\rvf67\anaconda3\lib\site-packages (from scikit-learn->-r requirements.txt (line 1)) (2.2.0)
Requirement already satisfied: joblib>=1.1.1 in c:\users\rvf67\anaconda3\lib\site-packages (from scikit-learn->-r requirements.txt (line 1)) (1.1.1)
Requirement already satisfied: python-dateutil>=2.8.1 in c:\users\rvf67\anaconda3\lib\site-packages (from pandas->-r requirements.txt (line 2)) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in c:\users\rvf67\anaconda3\lib\site-packages (from pandas->-r requirements.txt (line 2)) (2022.7)
Requirement already satisfied: Werkzeug>=2.2.2 in c:\users\rvf67\anaconda3\lib\site-packages (from flask->-r requirements.txt (line 4)) (2.2.2)
Requirement already satisfied: Jinja2>=3.0 in c:\users\rvf67\anaconda3\lib\site-packages (from flask->-r requirements.txt (line 4)) (3.1.2)
Requirement already satisfied: itsdangerous>=2.0 in c:\users\rvf67\anaconda3\lib\site-packages (from flask->-r requirements.txt (line 4)) (2.0.1)
Requirement already satisfied: click>=8.0 in c:\users\rvf67\anaconda3\lib\site-packages (from flask->-r requirements.txt (line 4)) (8.0.4)
Requirement already satisfied: colorama in c:\users\rvf67\anaconda3\lib\site-packages (from click>=8.0->flask->-r requirements.txt (line 4)) (0.4.6)
Requirement already satisfied: MarkupSafe>=2.0 in c:\users\rvf67\anaconda3\lib\site-packages (from Jinja2>=3.0->flask->-r requirements.txt (line 4)) (2.1.1)
Requirement already satisfied: six>=1.5 in c:\users\rvf67\anaconda3\lib\site-packages (from python-dateutil>=2.8.1->pandas->-r requirements.txt (line 2)) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</pre>
### ì´ì œ ìŠ¤íƒ€ì¼ê³¼ htmlê³¼ app.pyë¥¼ ë§Œë“¤ì–´ ìµœì¢… í”„ë¡œê·¸ë¨ì„ ë§Œë“ ë‹¤.


## ìŠ¤íƒ€ì¼

body {

	width: 100%;

	height: 100%;

	font-family: 'Helvetica';

	background: black;

	color: #fff;

	text-align: center;

	letter-spacing: 1.4px;

	font-size: 30px;

}



input {

	min-width: 150px;

}



.grid {

	width: 300px;

	border: 1px solid #2d2d2d;

	display: grid;

	justify-content: center;

	margin: 20px auto;

}



.box {

	color: #fff;

	background: #2d2d2d;

	padding: 12px;

	display: inline-block;

}


## html

<!DOCTYPE html>

<html>

  <head>

    <meta charset="UTF-8">

    <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

  </head>



  <body>

    <div class="grid">



      <div class="box">



        <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>



        <form action="{{ url_for('predict')}}" method="post">

          <input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />

          <input type="text" name="latitude" placeholder="Latitude" required="required" />

          <input type="text" name="longitude" placeholder="Longitude" required="required" />

          <button type="submit" class="btn">Predict country where the UFO is seen</button>

        </form>



        <p>{{ prediction_text }}</p>



      </div>



    </div>



  </body>

</html>


## app.py

import numpy as np

from flask import Flask, request, render_template

import pickle



app = Flask(__name__)



model = pickle.load(open("./ufo-model.pkl", "rb"))





@app.route("/")

def home():

    return render_template("index.html")





@app.route("/predict", methods=["POST"])

def predict():



    int_features = [int(x) for x in request.form.values()]

    final_features = [np.array(int_features)]

    prediction = model.predict(final_features)



    output = prediction[0]



    countries = ["Australia", "Canada", "Germany", "UK", "US"]



    return render_template(

        "index.html", prediction_text="Likely country: {}".format(countries[output])

    )





if __name__ == "__main__":

    app.run(debug=True)

